(function(a){a.fn.charCounter=function(b,c){b=b||100;c=a.extend({container:"<span></span>",classname:"charcounter",format:"(%1 characters remaining)",pulse:true,delay:0},c);var g,f;function e(i,h){i=a(i);if(i.val().length>b){i.val(i.val().substring(0,b));if(c.pulse&&!g){d(h,true)}}if(c.delay>0){if(f){window.clearTimeout(f)}f=window.setTimeout(function(){h.html(c.format.replace(/%1/,(b-i.val().length)))},c.delay)}else{h.html(c.format.replace(/%1/,(b-i.val().length)))}}function d(h,i){if(g){window.clearTimeout(g);g=null}h.animate({opacity:0.1},100,function(){a(this).animate({opacity:1},100)});if(i){g=window.setTimeout(function(){d(h)},200)}}return this.each(function(){var h=(!c.container.match(/^<.+>$/))?a(c.container):a(c.container).insertAfter(this).addClass(c.classname);a(this).bind("keydown",function(){e(this,h)}).bind("keypress",function(){e(this,h)}).bind("keyup",function(){e(this,h)}).bind("focus",function(){e(this,h)}).bind("mouseover",function(){e(this,h)}).bind("mouseout",function(){e(this,h)}).bind("paste",function(){var i=this;setTimeout(function(){e(i,h)},10)});if(this.addEventListener){this.addEventListener("input",function(){e(this,h)},false)}e(this,h)})}})(jQuery);