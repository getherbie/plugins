jQuery.fn.editable=function(d,i,h){if(this.length===0){return(this)}var a={target:d,name:"value",id:"id",type:"text",width:"auto",height:"auto",event:"click",onblur:"cancel",loadtype:"GET",loadtext:"Loading...",loaddata:{},submitdata:{}};if(i){jQuery.extend(a,i)}var c=jQuery.editable.types[a.type].plugin||function(){};var f=jQuery.editable.types[a.type].submit||function(){};var g=jQuery.editable.types[a.type].buttons||jQuery.editable.types.defaults.buttons;var e=jQuery.editable.types[a.type].content||jQuery.editable.types.defaults.content;var b=jQuery.editable.types[a.type].element||jQuery.editable.types.defaults.element;h=h||function(){};jQuery(this).attr("title",a.tooltip);a.autowidth="auto"==a.width;a.autoheight="auto"==a.height;jQuery(this)[a.event](function(p){var j=this;if(j.editing){return}if(a.width!="none"){a.width=a.autowidth?jQuery(j).width():a.width}if(a.height!="none"){a.height=a.autoheight?jQuery(j).height():a.height}j.editing=true;j.revert=jQuery(j).html();j.innerHTML="";var o=document.createElement("form");if(a.cssclass){if("inherit"==a.cssclass){jQuery(o).attr("class",jQuery(j).attr("class"))}else{jQuery(o).attr("class",a.cssclass)}}if(a.style){if("inherit"==a.style){jQuery(o).attr("style",jQuery(j).attr("style"));jQuery(o).css("display",jQuery(j).css("display"))}else{jQuery(o).attr("style",a.style)}}var m=b.apply(o,[a,j]);if(a.getload){a.loadurl=a.getload;a.loadtype="GET"}else{if(a.postload){a.loadurl=a.postload;a.loadtype="POST"}}if(a.loadurl){var l=setTimeout(function(){m.disabled=true;e.apply(o,[a.loadtext,a,j])},100);var k={};k[a.id]=j.id;if(jQuery.isFunction(a.loaddata)){jQuery.extend(k,a.loaddata.apply(j,[j.revert,a]))}else{jQuery.extend(k,a.loaddata)}jQuery.ajax({type:a.loadtype,url:a.loadurl,data:k,success:function(r){window.clearTimeout(l);e.apply(o,[r,a,j]);m.disabled=false}})}else{if(a.data){var q=a.data;if(jQuery.isFunction(a.data)){var q=a.data.apply(j,[j.revert,a])}e.apply(o,[q,a,j])}else{e.apply(o,[j.revert,a,j])}}m.name=a.name;g.apply(o,[a,j]);j.appendChild(o);if(a.select){m.select()}c.apply(o,[a,j]);jQuery(":input:visible:enabled:first",o).focus();jQuery(m).keydown(function(r){if(r.keyCode==27){r.preventDefault();n()}});var l;if("cancel"==a.onblur){jQuery(m).blur(function(r){l=setTimeout(n,500)})}else{if("submit"==a.onblur){jQuery(m).blur(function(r){jQuery(o).submit()})}else{jQuery(m).blur(function(r){})}}jQuery(o).submit(function(s){if(l){clearTimeout(l)}s.preventDefault();f.apply(o,[a,j]);if(jQuery.isFunction(a.target)){var t=a.target.apply(j,[jQuery(m).val(),a]);j.innerHTML=t;j.editing=false;h.apply(j,[j.innerHTML,a])}else{var r={};r[m.name]=jQuery(m).val();r[a.id]=j.id;if(jQuery.isFunction(a.submitdata)){jQuery.extend(r,a.submitdata.apply(j,[j.revert,a]))}else{jQuery.extend(r,a.submitdata)}jQuery(j).html(a.indicator);jQuery.post(a.target,r,function(u){j.innerHTML=u;j.editing=false;h.apply(j,[j.innerHTML,a])})}return false});function n(){j.innerHTML=j.revert;j.editing=false}});return(this)};jQuery.editable={types:{defaults:{element:function(c,b){var a=jQuery('<input type="hidden">');jQuery(this).append(a);return(a)},content:function(a,c,b){jQuery(":input:first",this).val(a)},buttons:function(b,a){if(b.submit){var d=jQuery('<input type="submit">');d.val(b.submit);jQuery(this).append(d)}if(b.cancel){var c=jQuery('<input type="button">');c.val(b.cancel);jQuery(this).append(c);jQuery(c).click(function(){jQuery(a).html(a.revert);a.editing=false})}}},text:{element:function(c,b){var a=jQuery("<input>");if(c.width!="none"){a.width(c.width)}if(c.height!="none"){a.height(c.height)}a.attr("autocomplete","off");jQuery(this).append(a);return(a)}},textarea:{element:function(c,b){var a=jQuery("<textarea>");if(c.rows){a.attr("rows",c.rows)}else{a.height(c.height)}if(c.cols){a.attr("cols",c.cols)}else{a.width(c.width)}jQuery(this).append(a);return(a)}},select:{element:function(c,b){var a=jQuery("<select>");jQuery(this).append(a);return(a)},content:function(string,settings,original){var select=jQuery("select",this);if(String==string.constructor){eval("var json = "+string);for(var key in json){if("selected"==key){continue}var option=$("<option>").val(key).append(json[key]);select.append(option)}}jQuery.editable.types.select.iefix(select,json.selected)},iefix:function(a,b){console.log(this);console.log(a);a.children().each(function(){if(jQuery(this).val()==b){jQuery(this).attr("selected","selected")}})}}},addInputType:function(b,a){jQuery.editable.types[b]=a}};